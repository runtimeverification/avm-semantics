declareTealSource "min-balance-asset-opt-out.teal";
declareTealSource "clear-basic.teal";

addAccount <address> b"1" </address> <balance> 100000 </balance>;
addAccount <address> b"2" </address> <balance> 100000 </balance>;

#initTxGroup();

// Add asset
addAssetConfigTx <txID> 0 </txID>
                 <sender>              b"1"        </sender>
                 <configAsset>         NoTValue    </configAsset>
                 <configTotal>         500         </configTotal>
                 <configDecimals>      0           </configDecimals>
                 <configDefaultFrozen> 0           </configDefaultFrozen>
                 <configUnitName>      "testcoins" </configUnitName>
                 <configAssetName>     "testcoin"  </configAssetName>
                 <configAssetURL>      NoTValue    </configAssetURL>
                 <configMetaDataHash>  NoTValue    </configMetaDataHash>
                 <configManagerAddr>   b"1"        </configManagerAddr>
                 <configReserveAddr>   NoTValue    </configReserveAddr>
                 <configFreezeAddr>    NoTValue    </configFreezeAddr>
                 <configClawbackAddr>  NoTValue    </configClawbackAddr>;

// Opt b"2" in to asset
addAssetTransferTx <txID> 1 </txID>
                   <sender>        b"2"     </sender>
                   <xferAsset>     1        </xferAsset>
                   <assetAmount>   0        </assetAmount>
                   <assetASender>  NoTValue </assetASender>
                   <assetReceiver> b"2"     </assetReceiver>
                   <assetCloseTo>  NoTValue </assetCloseTo>;

// Opt b"2" out of asset
addAssetTransferTx <txID> 2 </txID>
                   <sender>        b"2"     </sender>
                   <xferAsset>     1        </xferAsset>
                   <assetAmount>   0        </assetAmount>
                   <assetASender>  NoTValue </assetASender>
                   <assetReceiver> b"2"     </assetReceiver>
                   <assetCloseTo>  b"1"     </assetCloseTo>;

// Create app 1
addAppCallTx <txID> 3 </txID>
             <sender>            b"1"        </sender>
             <applicationID>     0           </applicationID>
             <onCompletion>      @ OptIn     </onCompletion>
             <accounts>          .TValueList </accounts>
             <applicationArgs>   .TValueList </applicationArgs>
             <foreignApps>       .TValueList </foreignApps>
             <foreignAssets>     .TValueList </foreignAssets>
             <globalNui>         0           </globalNui>
             <globalNbs>         0           </globalNbs>
             <localNui>          0           </localNui>
             <localNbs>          0           </localNbs>
             <extraProgramPages> 0           </extraProgramPages>
             <approvalPgmIdx>    0           </approvalPgmIdx>
             <clearStatePgmIdx>  1           </clearStatePgmIdx>;

// Call test code
addAppCallTx <txID> 4 </txID>
             <sender>            b"2"        </sender>
             <applicationID>     1           </applicationID>
             <onCompletion>      @ NoOp      </onCompletion>
             <accounts>          .TValueList </accounts>
             <applicationArgs>   .TValueList </applicationArgs>
             <foreignApps>       .TValueList </foreignApps>
             <foreignAssets>     .TValueList </foreignAssets>
             <globalNui>         0           </globalNui>
             <globalNbs>         0           </globalNbs>
             <localNui>          0           </localNui>
             <localNbs>          0           </localNbs>
             <extraProgramPages> 0           </extraProgramPages>
             <approvalPgmIdx>    0           </approvalPgmIdx>
             <clearStatePgmIdx>  1           </clearStatePgmIdx>;

#initGlobals(); #evalTxGroup(); .AS
